---
layout: post
title: 05 Campanas - Crear un videojuego 2D con Ruby y Gosu
date: '2017-11-06T20:33:00.000+01:00'
author: AITOR TOMAS PIN
tags: 
modified_time: '2017-12-29T18:48:02.225+01:00'
thumbnail: https://2.bp.blogspot.com/-F1ATYHWIx1M/WkYy_eRLe4I/AAAAAAAAADI/9jzyuk6ph4kbXV6UQdwOYckph5o6OLgjwCLcBGAs/s72-c/bells_bg.png
blogger_id: tag:blogger.com,1999:blog-611028137431305192.post-6170068380570480567
blogger_orig_url: http://compupiensaumh.blogspot.com/2017/11/05-campanas-crear-un-videojuego-2d-con-ruby-y-gosu.html
---

En los posts anteriores hemos visto como crear un videojuego utilizando Ruby y la gema Gosu:<br />- <a href="https://compupiensaumh.blogspot.com.es/2017/10/01-prerrequisitos-crear-un-videojuego-2d-con-ruby-y-gosu.html">01 Prerrequisitos</a>: Los prerrequisitos iniciales para poder comenzar a desarrollar nuestro juego con Ruby y Gosu.<br />- <a href="https://compupiensaumh.blogspot.com.es/2017/10/02-hola-mundo-crear-un-videojuego-2d-con-ruby-y-gosu.html">02 Hola mundo</a>: Un pequeño programa Hola Mundo para introducirnos en el mundo de Gosu.<br />- <a href="https://compupiensaumh.blogspot.com.es/2017/12/03-descripcion-crear-un-videojuego-2d-con-ruby-y-gosu.html">03 Descripción</a>: Descripción del ejercicio a realizar y especificaciones del juego.<br />- <a href="https://compupiensaumh.blogspot.com.es/2017/11/04-medios-crear-un-videojuego-2d-con-ruby-y-gosu.html">04 Medios</a>: Definición de los medios gráficos y de audio a utilizar en el juego.<br /><br />Como hemos definido en las especificaciones, vamos a tener en pantalla 5 campanas y cada una de ellas va a representar una nota musical: DO, RE, MI, FA o SOL.<br /><br />Para ello, vamos a crear una clase "Bell" que tenga como argumentos del constructor (método "initialize()"), la posición en X e Y de la campana en la pantalla y la nota musical que representa: <div class="codebox"><pre><br /><span>class Bell</span><br /><span>  def initialize(window, x, y, note)</span><br /><span>    @window = window</span><br /><span>    @position_x = x</span><br /><span>    @position_y = y</span><br /><span>    @note = note</span><br /><span>    @bell = Gosu::Image.new("media/bell.png")</span><br /><span>  end</span><br /><span></span><br /><span>  def click</span><br /><span>    @bell = Gosu::Image.new("media/bell_click.png")</span><br /><span>    @note.play</span><br /><span>  end</span><br /><span></span><br /><span>  def unclick</span><br /><span>    @bell = Gosu::Image.new("media/bell.png")</span><br /><span>  end</span><br /><span></span><br /><span>  def draw</span><br /><span>    @bell.draw(@position_x, @position_y, 1)</span><br /><span>  end</span><br /><span>end</span><br /></pre></div><br />El código de la clase Bell lo vamos a guardar en un fichero llamado "bell.rb" en una carpeta llamada "lib".<br /><br />Hemos añadido los métodos "click()" y "unclick()" que cambián la imagen de la campana dependiendo del estado en el que se encuentra. En el método "click()" además le decimos a Gosu que tiene que reproducir la nota musical "@note.play". El argumento "note" será un objeto del tipo Gosu::Sample (archivo de audio).<br /><br />Finalmente, tenemos el método "draw()" para definir como se muestra en pantalla.<br /><br />Para mostrar en la pantalla las campanas: <div class="codebox"><pre><br /><span>require "gosu"</span><br /><span>require_relative "lib/bell"</span><br /><span></span><br /><span>BELLS = [</span><br /><span>  "media/do.wav",</span><br /><span>  "media/re.wav",</span><br /><span>  "media/mi.wav",</span><br /><span>  "media/fa.wav",</span><br /><span>  "media/sol.wav"</span><br /><span>]</span><br /><span></span><br /><span>class Game < Gosu::Window</span><br /><span>  def initialize</span><br /><span>    super 800, 600</span><br /><span>    self.caption = "Juego de las campanas"</span><br /><span>    @background_image = Gosu::Image.new("media/bg.png", :tileable => true)</span><br /><span>    @bells = Array.new</span><br /><span>    BELLS.each_with_index do |tone, index|</span><br /><span>      position_x = ((self.width / BELLS.size) * index) + 30</span><br /><span>      @bells << Bell.new(self, position_x, 465, Gosu::Sample.new(tone))</span><br /><span>    end</span><br /><span>  end</span><br /><span></span><br /><span>  def update</span><br /><span>  end</span><br /><span></span><br /><span>  def draw</span><br /><span>    @background_image.draw(0, 0, 0)</span><br /><span>    @bells.each do |bell|</span><br /><span>      bell.draw</span><br /><span>    end</span><br /><span>  end</span><br /><span>end</span><br /><span></span><br /><span>window = Game.new</span><br /><span>window.show</span><br /></pre></div><br />Hemos definido una constante BELLS de tipo vector (Array), en la cual definimos la ruta a los audios de las distintas notas. Esto además, nos sirve como orden de las notas al mostrarlas en pantalla. Recorremos esa constante BELLS ("each_with_index") y creamos las 5 campanas, una para cada nota y en su posición correspondiente. En el método "draw()" de nuestra clase Game, dibujamos cada una de las campanas en pantalla.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-F1ATYHWIx1M/WkYy_eRLe4I/AAAAAAAAADI/9jzyuk6ph4kbXV6UQdwOYckph5o6OLgjwCLcBGAs/s1600/bells_bg.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="599" data-original-width="796" height="240" src="https://2.bp.blogspot.com/-F1ATYHWIx1M/WkYy_eRLe4I/AAAAAAAAADI/9jzyuk6ph4kbXV6UQdwOYckph5o6OLgjwCLcBGAs/s320/bells_bg.png" width="320" /></a></div><br />